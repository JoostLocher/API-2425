{% layout "server/layouts/base.liquid" %}

{% block content %}

<div class="memory-page">

<div class="memory-game">
  <div class="game-header">
    <h2>{{ pokemon.name | capitalize }} Memory Game</h2>
    <p>Match pairs of Pokémon sprites to win!</p>
  </div>

  <div class="game-info">
    <div class="moves">Moves remaining: <span id="moves-left">30</span></div>
    <div class="timer">Time: <span id="timer">01:00</span></div>
  </div>

  <div class="memory-grid" id="memory-grid" data-pokemon="{{ pokemon.name }}">
    {% for card in cards %}
      <div class="memory-card" data-sprite="{{ card.id }}">
        <div class="card-front">
          <img src="{{ card.sprite }}" alt="{{ pokemon.name }}">
        </div>
        <div class="card-back"></div>
      </div>
    {% endfor %}
  </div>

  <!-- Win Message -->
  <div class="win-message" id="win-message">
    <h3>Congratulations!</h3>
    <p>You matched all {{ cards.size | divided_by: 2 }} pairs!</p>
    
    <!-- Pokemon sprite display -->
    <div class="collected-pokemon-display">
      <img src="{{ pokemon.sprites.front_default }}" alt="{{ pokemon.name }}" class="collected-pokemon-sprite">
      <p>You've collected a {{ pokemon.name | capitalize }} card for your binder!</p>
    </div>

    <div class="message-buttons">
      <a href="/binder" class="game-button">View Binder</a>
      <a href="/" class="game-button">Back to Pokémon List</a>
    </div>
  </div>
  
  <!-- Lose Message -->
  <div class="lose-message" id="lose-message">
    <h3>Game Over</h3>
    <p id="lose-reason">You ran out of moves!</p>
    <p>Better luck next time!</p>
    <div class="message-buttons">
      <a href="#" class="game-button" onclick="location.reload()">Try Again</a>
      <a href="/" class="game-button">Back to Pokémon List</a>
    </div>
  </div>
</div>

</div>

{% endblock %}